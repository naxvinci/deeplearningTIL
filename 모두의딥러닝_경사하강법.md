# 경사하강법

> 기울기를 너무 크거나 작게 잡으면 오차가 커지는 상관 관계는 이차 함수 그래프로 그리는 것이 가능

- 오차가 가장 작은 점은 x가 그래프의 가장 아래쪽의 볼록한 부분에 이르렀을 때.
- **경사하강법** : 그래프에서 오차를 비교하여 가장 작은 방향으로 이동시키는 방법// 미분 기울기를 이용

#### 미분

• f(x) = a(a는 상수)일 때 미분 값은 0

• f(x) = x일 때 미분 값은 1

• f(x) = ax(a는 상수)일 때 미분 값은 a



#### 경사하강법 과정

1. 임의의 점에서 미분을 구한다
2. 구해진 기울기의 반대방향(기울기가 +면 음의 방향, -면 양의 방향)으로 얼마간 이동시킨 점에서 미분을 구한다
3. 다음 점에서 미분을 구한다. 
4. 3의 값이 0이 아니면 위과정을 반복



### 학습률

- 기울기의 부호를 바꿔 이동 시킬 때 적절한 거리를 찾지못해 너무 멀리 이동시키면 a 값이 한 점으로 모이지 않고 위로 솟아버리게 된다
- 딥러닝에서 학습률의 값을 적절히 바꾸면서 최적의 학습률을 찾는 것은 중요한 최적화 과정 중 하나



### 코딩

```python
import tensorflow as tf

data = [[2, 81], [4, 93], [6, 91], [8, 97]]
x_data = [x_row[0] for x_row in data]
y_data = [y_row[1] for y_row in data]

learning_rate = 0.1

```

- 기울기 a 와 y절편 b의 값을 임의로 정한다

  ```python
  a = tf.Variable(tf.random_uniform([1], 0, 10, dtype = tf.float64, seed = 0))
  b = tf.Variable(tf.random_uniform([1], 0, 100, dtype = tf.float64, seed = 0))
  ```

  - https://thebook.io/006958/part02/ch04/04-02/

